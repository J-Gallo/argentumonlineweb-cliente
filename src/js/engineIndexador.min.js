var loader="";var canvasBackground="";$(document).ready(function(){canvasBackground=document.getElementById("background").getContext("2d");loader=new PxLoader();
loader.addCompletionListener(function(a){engine.loop();});});var inits=new function(){this.graphics={};this.heads={};this.bodies={};this.fxs={};this.armas={};
this.loadGraphics=function(){$.get("../../init/graficos.json",function(a){inits.graphics=JSON.parse(a);$.each(inits.graphics,function(c,b){if(b.imagen){inits.graphics[c].imagen=loader.addImage("../graphics/"+inits.graphics[c].numFile+".png");
}});loader.start();});};this.loadHeads=function(c){var b=0;var a=0;$.get("../../init/heads.json",function(d){inits.heads=JSON.parse(d);c(true);});};this.loadBodies=function(c){var b=0;
var a=0;$.get("../../init/bodies.json",function(d){inits.bodies=JSON.parse(d);c(true);});};this.loadArmas=function(c){var b=0;var a=0;$.get("../../init/armas.json",function(d){inits.armas=JSON.parse(d);
c(true);});};this.loadFxs=function(c){var b=0;var a=0;$.get("../../init/fxs.json",function(d){inits.fxs=JSON.parse(d);c(true);});};}();var engine=new Engine();
function Engine(){var z=0.014;var w=0;var l=0;var v=0;var r=0;var q=0;var i=0;this.ping=0;var f=0;var e=0;var c=9;var a=9;this.loop=function(){try{w=performance.now()-l;
l=performance.now();b();requestAnimationFrame(engine.loop);}catch(B){dumpError(B);}};function b(){h();var C=inits.graphics[13103];var E=inits.graphics[$("#grhSelected").val()];
var B=3;var D=10;count=0;$.each(inits.graphics[inits.bodies[1][1]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,20+(count*40),30,G.width,G.height);
count++;});count=0;$.each(inits.graphics[inits.bodies[1][2]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,20+(count*40),130,G.width,G.height);
count++;});count=0;$.each(inits.graphics[inits.bodies[1][3]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,20+(count*40),230,G.width,G.height);
count++;});count=0;$.each(inits.graphics[inits.bodies[1][4]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,20+(count*40),330,G.width,G.height);
count++;});if($("#grh").val()){canvasBackground.strokeStyle="red";count=0;$.each(inits.graphics[inits.armas[$("#grh").val()][1]].frames,function(F,H){var G=inits.graphics[H];
console.log(G.offsetX);canvasBackground.strokeRect(20.5+(count*40),30.5,G.width,G.height);canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,(20+(count*40))+G.offsetX,30+G.offsetX,G.width,G.height);
count++;});count=0;$.each(inits.graphics[inits.armas[$("#grh").val()][2]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.strokeRect(20.5+(count*40),130.5,G.width,G.height);
canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,(20+(count*40))+G.offsetX,130+G.offsetX,G.width,G.height);count++;});count=0;$.each(inits.graphics[inits.armas[$("#grh").val()][3]].frames,function(F,H){var G=inits.graphics[H];
canvasBackground.strokeRect(20.5+(count*40),230.5,G.width,G.height);canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,(20+(count*40))+G.offsetX,230+G.offsetY,G.width,G.height);
count++;});count=0;$.each(inits.graphics[inits.armas[$("#grh").val()][4]].frames,function(F,H){var G=inits.graphics[H];canvasBackground.strokeRect(20.5+(count*40),330.5,G.width,G.height);
canvasBackground.drawImage(G.imagen,G.sX,G.sY,G.width,G.height,(20+(count*40))+G.offsetX,330+G.offsetX,G.width,G.height);count++;});}}function h(){canvasBackground.clearRect(0,0,300,400);
}var A=0;var u=0;var m=0;var k=0;function o(E,B,F,D){try{if(E.imagen){if(D){canvasBackground.globalAlpha=0.5;}canvasBackground.drawImage(E.imagen,E.sX,E.sY,E.width,E.height,B,F,E.width,E.height);
if(D){canvasBackground.globalAlpha=1;}}}catch(C){dumpError(C);}}function t(E,B,F,D){try{if(E.imagen){if(D){canvasBackground.globalAlpha=0.5;}canvasBackground.drawImage(E.imagen,E.sX,E.sY,E.width,E.height,B,F,E.width,E.height);
if(D){canvasBackground.globalAlpha=1;}}}catch(C){dumpError(C);}}function n(E,C,B){try{d(E,C,B,true);}catch(D){dumpError(D);}}var s=4;var j=25;var p=8;var g=34;
function y(H,R,Q){try{var ae=H.nameCharacter.length*3.5;if(w){var aa=inits.bodies[H.idBodyNaked][H.heading];var ac=inits.heads[H.idHead][H.heading];var af="";
if(H.idBody){af=inits.bodies[H.inv[H.idBody].idAnimationItem][H.heading];}var Z="";if(H.idHelmet){Z=inits.heads[H.idHelmet][H.heading];}if(H.idWeapon){var P=inits.armas[H.inv[H.idWeapon].idAnimationItem][H.heading];
var W=inits.armas[H.inv[H.idWeapon].idAnimationItem][5];var V=inits.armas[H.inv[H.idWeapon].idAnimationItem][6];}var L=inits.heads[H.idHead][5];var E=inits.heads[H.idHead][6];
if(Z){var T=inits.heads[H.idHelmet][5];var F=inits.heads[H.idHelmet][6];}if(H.moving){H.frameCounter=H.frameCounter+(w*1/inits.graphics[aa].speed);if(H.frameCounter<1){H.frameCounter=1;
}if(H.frameCounter>inits.graphics[aa].numFrames){H.frameCounter=1;}}if(aa){if(H.frameCounter>0&&Math.floor(H.frameCounter)<inits.graphics[aa].numFrames){var ah=inits.graphics[aa].frames[Math.floor(H.frameCounter)];
var X="";if(af){var ab=inits.graphics[af].frames[Math.floor(H.frameCounter)];X=inits.graphics[ab];}var S=inits.graphics[ah];var ak=inits.graphics[ac];var G="";
if(Z){G=inits.graphics[Z];}if(H.idWeapon){var N=inits.graphics[P].frames[Math.floor(H.frameCounter)];var M=inits.graphics[N];var O=M.width;var ai=M.height;
}var B=S.width;var D=S.height;var U=ak.width;var I=ak.height;if(X){var ad=X.width;var J=X.height;}if(G){var aj=G.width;var C=G.height;}canvasBackground.drawImage(ak.imagen,ak.sX,ak.sY,U,I,R+L,Q-E,U,I);
if(G){canvasBackground.drawImage(G.imagen,G.sX,G.sY,aj,C,R+T,Q-F,aj,C);}canvasBackground.drawImage(S.imagen,S.sX,S.sY,B,D,R+s,Q-j,B,D);if(X){canvasBackground.drawImage(X.imagen,X.sX,X.sY,ad,J,R+s,Q-j,ad,J);
}if(M){canvasBackground.drawImage(M.imagen,M.sX,M.sY,O,ai,R+s,Q-j,O,ai);}nameX=R-ae+16;renderText(H.nameCharacter,nameX,Q+30,H.color,true,15,"Tahoma");
if(H.clan){var K=H.clan.length*4;clanX=R-K+16;renderText(H.clan,clanX,Q+50,H.color,true,15,"Tahoma");}if(H.rango){renderRango(H.rango,nameX-15,Q+18);}if(dialogs[H.id]){textLength=dialogs[H.id].msg.length;
var Y;if(textLength>=30){Y=45;}else{Y=textLength*3;}dialogX=R+32-Y;renderDialog(H.id,dialogX,Q-40,dialogs[H.id].color,true,14,"Tahoma");}}}}}catch(ag){dumpError(ag);
}}var x=0;function d(K,D,B,G){try{if(w){var E=$("#anim").val();x+=(w*1/inits.graphics[E].speed);if(x>inits.graphics[E].numFrames){x=0;}if(x>0&&x<inits.graphics[E].numFrames){var J=inits.graphics[E].frames[Math.ceil(x)];
$("#grhActual").val(J);var H=inits.graphics[J];var C=H.width;var I=H.height;if(G){canvasBackground.globalAlpha=0.6;}canvasBackground.drawImage(H.imagen,H.sX,H.sY,C,I,D,B,C,I);
if(G){canvasBackground.globalAlpha=1;}}}}catch(F){dumpError(F);}}}function listJSON(c,a,e){var b={};var d=a;$.each(c,function(f,h){if(h.numFile){h.numFile=e;
}if(parseInt(h.numFrames)===1){h.frames[1]=a;}else{if(parseInt(h.numFrames)>1){var g={};$.each(h.frames,function(i,j){g[i]=d;d++;});h.frames=g;}}b[a]=h;
a++;});console.log(JSON.stringify(b));}function dumpError(a){if(typeof a==="object"){if(a.message){console.log("\nMessage: "+a.message);}if(a.stack){console.log("\nStacktrace:");
console.log("====================");console.log(a.stack);}}else{console.log("dumpError :: argument is not an object");}}